# =============================================================================
# Lynex - Environment Variables
# =============================================================================
# Copy this file to `.env` and fill in the values.
# NEVER commit your .env file to git!
#
# For environment-specific templates, see: config/environments/
#   - development.env  (local development)
#   - staging.env      (pre-production testing)
#   - production.env   (live deployment)
# =============================================================================

# =============================================================================
# Environment
# =============================================================================
ENV=development                    # Options: development, staging, production
DEBUG=true                         # Enable debug mode (false in production)

# =============================================================================
# Database - ClickHouse
# =============================================================================
# Option 1: Local Docker
#   docker run -d --name clickhouse -p 8123:8123 -p 9000:9000 clickhouse/clickhouse-server
#
# Option 2: DigitalOcean Droplet ($6/mo with Student Pack)
#   Run: ./infra/deploy-clickhouse.sh
#
# Option 3: Managed Service
#   - Aiven (https://aiven.io) - Free tier available
#   - Tinybird (https://tinybird.co) - Free tier available

CLICKHOUSE_HOST=localhost          # REQUIRED: ClickHouse server hostname
CLICKHOUSE_PORT=9000               # REQUIRED: Native protocol port (not HTTP 8123)
CLICKHOUSE_USER=default            # REQUIRED: Database user
CLICKHOUSE_PASSWORD=               # REQUIRED in production: Database password
CLICKHOUSE_DATABASE=default        # REQUIRED: Database name

# If you use MongoDB for persistence (optional in some services), configure here:
# Docker compose sets these in development. Example for local MongoDB:
MONGO_URL=mongodb://localhost:27017
MONGO_DB_NAME=watchllm

# =============================================================================
# Queue - Redis
# =============================================================================
# Option 1: Local Docker
#   docker run -d --name redis -p 6379:6379 redis:7
#
# Option 2: DigitalOcean Managed Redis ($7/mo dev tier)
#   Created automatically by App Platform
#
# Option 3: Upstash (https://upstash.com) - Free tier available

REDIS_URL=redis://localhost:6379   # REQUIRED: Full Redis connection URL
QUEUE_MODE=redis                   # Options: redis, memory (for testing only)

# Optional Upstash REST API (used by some deployments)
# For Upstash REST you will get a URL and token. Example:
# REDIS_REST_URL=https://your-region.upstash.io
# REDIS_REST_TOKEN=your-upstash-rest-token

# =============================================================================
# Authentication - Supabase
# =============================================================================
# Get free Supabase at: https://supabase.com
# Dashboard -> Settings -> API -> Project URL & API Keys

SUPABASE_URL=https://your-project.supabase.co           # REQUIRED: Project URL
SUPABASE_ANON_KEY=your-anon-key                         # REQUIRED: Anonymous (public) key
SUPABASE_SERVICE_KEY=your-service-role-key              # REQUIRED: Service role key (secret!)

# JWT signing secret (used for internal JWTs if applicable). Keep this secret.
# Make sure this matches any external auth provider requirement if you use one.
JWT_SECRET=your-very-secure-jwt-secret-change-this

# =============================================================================
# API Configuration
# =============================================================================
API_HOST=0.0.0.0                   # Listen on all interfaces
INGEST_API_PORT=8001               # Ingest API port
UI_BACKEND_PORT=8000               # UI Backend API port  
BILLING_PORT=8002                  # Billing service port

# CORS allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# =============================================================================
# Admin API
# =============================================================================
# Used for manual tier upgrades via POST /api/v1/admin/upgrade-user
# Generate with: openssl rand -base64 32

ADMIN_API_KEY=your-secret-admin-key                     # REQUIRED in production

# Whop (payments) integration - optional. If you use Whop for licensing/payments,
# set these keys. If not using Whop, leave blank.
WHOP_API_KEY=
WHOP_WEBHOOK_SECRET=

# =============================================================================
# Monitoring - Sentry
# =============================================================================
# Get free Sentry at: https://sentry.io
# Free tier: 5,000 errors/month - perfect for MVP
# Dashboard -> Settings -> Client Keys (DSN)

SENTRY_DSN=                        # OPTIONAL: Sentry DSN (recommended)
SENTRY_ENVIRONMENT=development     # Options: development, staging, production

# =============================================================================
# Monitoring - Datadog (Optional)
# =============================================================================
# Get API key from: https://app.datadoghq.com

DATADOG_ENABLED=false              # Enable Datadog APM
DATADOG_API_KEY=                   # Datadog API key
DD_SERVICE=lynex                   # Service name in Datadog
DD_ENV=development                 # Environment tag
DD_VERSION=1.0.0                   # Version tag

# Backwards-compatible alias (some local .env files use DATADOG_API)
# You can set either `DATADOG_API_KEY` or `DATADOG_API` depending on your tooling.
DATADOG_API=

# =============================================================================
# Frontend - Vite Environment Variables
# =============================================================================
# These are embedded at build time (prefix with VITE_)

VITE_API_URL=http://localhost:8000                      # REQUIRED: Backend API URL
VITE_SUPABASE_URL=https://your-project.supabase.co      # REQUIRED: Same as SUPABASE_URL
VITE_SUPABASE_ANON_KEY=your-anon-key                    # REQUIRED: Same as SUPABASE_ANON_KEY
VITE_SENTRY_DSN=                                        # OPTIONAL: Same as SENTRY_DSN
VITE_SENTRY_ENVIRONMENT=development                     # Same as SENTRY_ENVIRONMENT

# =============================================================================
# Quick Start Checklist
# =============================================================================
# Minimum required for local development:
#   [ ] CLICKHOUSE_HOST (or use Docker)
#   [ ] REDIS_URL (or use Docker)
#   [ ] SUPABASE_URL
#   [ ] SUPABASE_ANON_KEY
#   [ ] SUPABASE_SERVICE_KEY
#   [ ] VITE_API_URL
#   [ ] VITE_SUPABASE_URL
#   [ ] VITE_SUPABASE_ANON_KEY
#
# Additional for production:
#   [ ] CLICKHOUSE_PASSWORD
#   [ ] ADMIN_API_KEY (strong, unique)
#   [ ] SENTRY_DSN (recommended)
#   [ ] ENV=production
#   [ ] DEBUG=false
# =============================================================================
